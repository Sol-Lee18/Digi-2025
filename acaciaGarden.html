<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acacia Garden</title>
    <link href="./Images/logo.png" rel="shortcut icon" type="img/x-icon">
    <link href="./style.css" rel="stylesheet" type="text/css">
    <link href="./script.js">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=search" />
</head>
    
<body>
    <nav class="navbar">
        <div class="navItem1">
            <img id="AcaciapagesTitle" src="./Images/acaciapagesTitle.png" alt="AcaciapagesTitle" width="260"> 
        </div>
        <div class="navItem2">
            <ul>
                <li><a href="./index.html"><img id="navbarHomeIcon" src="./Images/navbarHomeIcon.png" width="80"></a></li>
                <li><a href="./acaciaGarden.html"><img id="navbarGardenIcon" src="./Images/navbarGardenIcon.png" width="80"></a></li>
                <li><a href="./editor.html"><img id="navbarCreateIcon" src="./Images/navbarCreateIcon.png" width="80"></a> </li>
            </ul>
        </div>
    </nav>

    <hr class="navbarLine">
    <br>
    <br>

    <div class="MainTitle"><h1>Acacia Garden</h1></div>

    <form>
        <div class="searchBar">
            <span class="searchIcon material-symbols-outlined">search</span>
            <input class="searchInput" type="search" placeholder="Search...">
            </ul>
        </div>
    </form>

    <div id="posts" class="gardenBody"></div>


    <div class="footer">
        <h1>Acaciapages</h1>
        <hr id="footerLine1">
        <hr id="footerLine2">
        <div class="shortcuts">
            <ul>
                <li><a href="./index.html"><img src="./Images/footerHomeIcon.png" width="40px"></a></li>
                <li><a href="./acaciaGarden.html"><img src="./Images/footerGardenIcon.png" width="40px"></a></li>
                <li><a href="./editor.html"><img src="./Images/footerCreateIcon.png" width="40px"></a></li>
            </ul>
        </div>
        <p>Â©2025SolLee</p>
    </div>


<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { getDatabase, ref, query, orderByChild, onValue} from "https://www.gstatic.com/firebasejs/12.1.0/firebase-database.js";


    const firebaseConfig = {
        apiKey: "AIzaSyDNCknujv99lhPkfXdQ4dRJVc-H8ZJg-M8",
        authDomain: "acacia-pages-database.firebaseapp.com",
        databaseURL: "https://acacia-pages-database-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "acacia-pages-database",
        storageBucket: "acacia-pages-database.firebasestorage.app",
        messagingSenderId: "456686471317",
        appId: "1:456686471317:web:8e04adffa50507c7ecf39c",
        measurementId: "G-47S5H3ZR6S"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const postsContainer = document.getElementById("posts");

        
    const postsQuery = query(ref(db, "posts"), orderByChild("timestamp"));

    onValue(postsQuery, (snapshot) => {
        postsContainer.innerHTML = ""; 
        const posts = [];

        snapshot.forEach((childSnapshot) => {
            posts.push({
                key: childSnapshot.key,
                ...childSnapshot.val()
            });
        });        

            
        posts.sort((a, b) => b.timestamp - a.timestamp);

            
        posts.forEach((post) => {
            const preview = document.createElement("div");
            preview.classList.add("preview");

            preview.innerHTML = `
                <div class="previewTitleDiv">
                    <h2 id="previewTitleOutput">${post.title || "Untitled"}</h2>
                    <h3 id="previewAuthorOutput">${post.author || "anonymous"}</h3>
                </div>
                <div class="previewBodyDiv">
                    <p id="previewBodyOutput">${post.content ? post.content.split(" ").slice(0, 30).join(" ") + (post.content.split(" ").length > 30 ? "..." : "") : ""}</p>
                </div>
                <div class="previewLikesGrid">
                    <button id="likeButton"><img src="./Images/heart.png"></button>
                    <span id="likeCount">${post.likes || 0}</span>
                    <button id="branchesButton"><img src="./Images/branch.png"></button>
                    <span id="branchesCount">${post.branches || 0}</span>
                </div>
            `;

            preview.querySelector(".previewBodyDiv").addEventListener("click", () => {
            window.location.href = `./post.html?postId=${post.key}`;
            });

            postsContainer.appendChild(preview);
            });

    });


    const searchBar = document.querySelector('.searchInput')
console.log(searchBar)

searchBar.addEventListener('keyup', (e) => {
   console.log(e.target.value)
})

</script>
<script src="./acaciaGarden.js"></script>
</body>
</html>



